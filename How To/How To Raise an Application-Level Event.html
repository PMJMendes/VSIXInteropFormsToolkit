<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <title>How To Raise an Application-Level Event</title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/helpstudio.css">
    <link rel="stylesheet" type="text/css" href="../stylesheets/MSDN.css">
    <link rel="stylesheet" type="text/css" href="../stylesheets/tree.css">
    <style type="text/css">
        div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle
        {
            background-color: #90C8FF;
            color: #000080;
        }
    </style>
    <xml>
        <MSHelp:RLTitle Title="Structuring the Migration Process"/>
        <MSHelp:Attr Name="DocSet" Value="InteropFormToolkit2.0"/>
        <MSHelp:Attr Name="TopicType" Value="kbRef"/>
	  <MSHelp:Attr Name="DevLang" Value="VB"/>
        <MSHelp:Keyword Index="F" Term="MicrosoftInteropFormToolkitIntroduction"/>
    </xml>
</head>
<body>
    <div id="pagetop">
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">Interop Forms Toolkit </span>
                </td>
                <td align="right">
                    <span id="feedbacklink">
                </td>
                </span> </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left" colspan="2">
                    <span id="pagetitle">How To Raise an Application-Level Event </span>
                </td>
            </tr>
        </table>
    </div>
    <div id="mainbody">
    <p><strong>Overview</strong></p>
<p>It is often required that components be made aware of events that occur
which affect an application as a whole.&nbsp; Examples include notification
that an application is starting up or shutting down, or that an unrecoverable
error has occurred. For this reason, the InteropToolbox provides an
EventMessenger object&nbsp;that allows you to send or receive notification of
application-level events.&nbsp;</p>
<p>&nbsp;</p>
<p>The following .NET code demonstrates raising an application-level
event.&nbsp; The InteropToolbox can be accessed from the My namespace.</p>
<div class="syntax">
    &nbsp;&nbsp;&nbsp; Private Sub lnkError_LinkClicked(ByVal sender As
    System.Object, _<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ByVal e As
    System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles
    lnkError.LinkClicked<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox("This will simulate a
    critical error occurring." &amp; vbNewLine &amp; _<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "An
    event will be raised to notify Visual Basic 6.0 that the application should
    shut down.", _<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBoxStyle.OkCancel,
    "Critical Error Event")<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    My.InteropToolbox.EventMessenger.RaiseApplicationEvent("CRITICAL_ERROR",
    _<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Sample
    Error Code.")<br>
    &nbsp;&nbsp;&nbsp; End Sub
</div>
    </div>
    <div id="pagefooter">
        <p>
            &nbsp;</p>
        <p>
            &nbsp;</p>
        <hr size="1">
        <p>
            Copyright &copy; by Microsoft Corporation. All Rights Reserved.
        </p>
    </div>
</body>
</html>
