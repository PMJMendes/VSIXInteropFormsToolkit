<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <title>Interop User Control Events</title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/helpstudio.css">
    <link rel="stylesheet" type="text/css" href="../stylesheets/MSDN.css">
    <link rel="stylesheet" type="text/css" href="../stylesheets/tree.css">
    <style type="text/css">
        div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle
        {
            background-color: #90C8FF;
            color: #000080;
        }
    </style>
    <xml>
        <MSHelp:RLTitle Title="Structuring the Migration Process"/>
        <MSHelp:Attr Name="DocSet" Value="InteropFormToolkit2.0"/>
        <MSHelp:Attr Name="TopicType" Value="kbRef"/>
	  <MSHelp:Attr Name="DevLang" Value="VB"/>
        <MSHelp:Keyword Index="F" Term="MicrosoftInteropFormToolkitIntroduction"/>
    </xml>
</head>
<body>
    <div id="pagetop">
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">Interop Forms Toolkit </span>
                </td>
                <td align="right">
                    <span id="feedbacklink">
                </td>
                </span> </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left" colspan="2">
                    <span id="pagetitle">Interop User Control Events </span>
                </td>
            </tr>
        </table>
    </div>
    <div id="mainbody">
    <p>Interop UserControls provide a&nbsp;basic set of intrinsic events
(<strong>Click</strong>, <strong>GotFocus</strong>, <strong>Validate</strong>,
etc.)&nbsp;in Visual Basic 6.0. You can define your own custom events in Visual
Studio .NET and raise them using <strong>RaiseEvent</strong>. In order to handle
the events in Visual Basic 6.0, you need to add a project reference and add a
<strong>WithEvents</strong> variable declaration in your code, and then handle
the events using the <strong>WithEvents</strong> variable rather than the
control itself.</p>

<h3 class="subHeading">How To&nbsp;Handle Interop&nbsp;UserControl Custom
    Events</h3>

<div class="subSection">
    <ol>
        <li>
            <p>In Visual Basic 6.0, on the <strong>Project</strong> menu, click
            <strong>References</strong>. Note that there is already a reference
            to <em>ControlName</em>Ctl, where <em>ControlName</em> is the name
            of your Interop UserControl.</p>
        </li>

        <li>
            <p>In&nbsp;the&nbsp;<strong>Available
            References</strong>&nbsp;list,&nbsp;locate a reference for
            <em>ControlName</em> and check it, and then click
            <strong>OK</strong>.</p>
        </li>

        <li>
            <p>In the <strong>Code Editor</strong>, add a declaration for a
            <strong>WithEvents</strong> variable:&nbsp;</p>

            <div class="code">
                <pre>
<font color=
"navy">Dim WithEvents <em>ControlName</em>Events As <em>ControlLibrary</em>.<em>ControlName</em></font>
                </pre>
            </div>
        </li>
    </ol>
</div>

<ul class="noindent"></ul>

<p><span codelanguage="other">In the Form_Load event handler, add the following
code to initialize the <strong>WithEvents</strong> variable:</span></p>

<div class="code">
    <blockquote><pre>
<font color=
"navy">Private Sub Form_Load()<br>    Set <em>ControlName</em>Events = Me.<em>ControlNameOnVB6Form</em><br>End Sub</font>
    </pre></blockquote>
</div>

<ul class="noindent"></ul>

<p><span codelanguage="other"><span codelanguage="other">Add code to handle
your custom event in the <strong>WithEvents</strong> variable's event
handler:</span></span></p>

<div class="code">
    <pre>
<font color=
"navy">Private Sub <em>ControlName</em>Events_MyCustomEvent()<br>    MsgBox("My custom event fired")<br>End Sub</font>
    </pre>
</div>

<div class="noindent" style="margin-left: 2em">
    </div>
    <div id="pagefooter">
        <p>
            &nbsp;</p>
        <p>
            &nbsp;</p>
        <hr size="1">
        <p>
            Copyright &copy; by Microsoft Corporation. All Rights Reserved.
        </p>
    </div>
</body>
</html>
